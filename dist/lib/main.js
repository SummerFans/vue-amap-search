!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o=t();for(var a in o)("object"==typeof exports?exports:e)[a]=o[a]}}(this,function(){return function(e){function t(a){if(o[a])return o[a].exports;var i=o[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,o){e.exports=o(4).default},function(e,t){},function(e,t){e.exports=function(e,t,o,a){var i,n=e=e||{},s=typeof e.default;"object"!==s&&"function"!==s||(i=e,n=e.default);var r="function"==typeof n?n.options:n;if(t&&(r.render=t.render,r.staticRenderFns=t.staticRenderFns),o&&(r._scopeId=o),a){var c=Object.create(r.computed||null);Object.keys(a).forEach(function(e){var t=a[e];c[e]=function(){return t}}),r.computed=c}return{esModule:i,exports:n,options:r}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"amap-search__container",style:{width:e.width+"px",height:e.height+"px"}},[o("div",{staticClass:"amap-search__autocomplate"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.autocomplateInput,expression:"autocomplateInput"}],attrs:{type:"text",id:"autocomplate-input",autocomplete:"off",placeholder:"输入详细地址,越详细定位越精准"},domProps:{value:e.autocomplateInput},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.searchDefaultSuggestion(t)},input:function(t){t.target.composing||(e.autocomplateInput=t.target.value)}}}),e._v(" "),o("a",{staticClass:"amap-search__search-btn",on:{click:e.searchDefaultSuggestion}},[e._v("\n          搜索\n      ")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedPoi.location.lat,expression:"selectedPoi.location.lat"}],ref:"marker-content",staticClass:"marker-content"},[o("div",{staticClass:"marker-content-header"},[o("span",{directives:[{name:"show",rawName:"v-show",value:0==e.selectedPoi.isMoved,expression:"selectedPoi.isMoved==false"}],staticClass:"notice-icon"},[e._v("⚑")]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:0==e.selectedPoi.isMoved,expression:"selectedPoi.isMoved==false"}],staticClass:"notice"},[e._v("已将坐标定位为")]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:e.selectedPoi.isMoved,expression:"selectedPoi.isMoved"}],staticClass:"notice"},[e._v("坐标定位")])]),e._v(" "),o("div",{staticClass:"marker-info"},[o("div",{staticClass:"marker-name"},[e._v(e._s(e.selectedPoi.name))]),e._v(" "),o("div",{staticClass:"marker-address"},[e._v(e._s(e.selectedPoi.address))])]),e._v(" "),o("a",{directives:[{name:"show",rawName:"v-show",value:e.selectedPoi.isMoved,expression:"selectedPoi.isMoved"}],staticClass:"amap-search__confirm-btn",on:{click:function(t){e.setMarkerLocation(e.selectedPoi)}}},[e._v("确定")])]),e._v(" "),o("div",{attrs:{id:"amap-container"}})])},staticRenderFns:[]}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(5);t.default={name:"amapSearch",data:function(){return{autocomplateInput:""}},watch:{autocomplateInput:function(e,t){this.$emit("userInput",e)},"selectedPoi.location.lat":function(e,t){if(this.autoConfirm){this.selectedPoi.isMoved=!1;var o=JSON.stringify(this.selectedPoi);this.$emit("pickedLocation",JSON.parse(o))}}},props:{defaultLng:{type:Number,default:39.90923,required:!1},defaultLat:{type:Number,default:116.397428,required:!1},defaultCity:{type:String,default:"上海",required:!1},searchCount:{type:Number,default:1,required:!1},width:{type:[String,Number],required:!0},height:{type:Number,required:!0},autoConfirm:{type:Boolean,default:!1,required:!1},icon:{type:String,default:'data:image/svg+xml;utf-8,<svg t="1504841519075" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5797" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20"><defs><style type="text/css"></style></defs><path d="M512 1024s460.8-258.2016 460.8-593.152C972.8 192.8704 766.5152 0 512 0s-460.8 192.8704-460.8 430.848C51.2 765.7984 512 1024 512 1024z m0-409.6a204.8 204.8 0 1 1 0-409.6 204.8 204.8 0 0 1 0 409.6z" fill="#FF6F5C" p-id="5798"></path></svg>',required:!1},useClick:{type:Boolean,default:!1,required:!1}},methods:{setMarkerLocation:function(){if(0==this.autoConfirm){this.selectedPoi.isMoved=!1;var e=JSON.stringify(this.selectedPoi);this.$emit("pickedLocation",JSON.parse(e))}}},mounted:function(){this.initAmap("amap-container",[this.defaultLat,this.defaultLng],this.icon);var e=this.autoConfirm?1:this.searchCount;this.useClick&&(this.initMouseTools(),e=1),this.initAutocomplate("autocomplate-input",e,this.defaultCity)},mixins:[a.amapmixinApp]}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.amapmixinApp={data:function(){return{map:{},autocomplete:{},placeSearch:{},amapCounty:{},geocoder:{},selectedPoi:{location:{lat:0,lng:0},address:"",name:"",isMoved:!0},editingPolygon:{},mouseTool:{}}},mounted:function(){},methods:{initAmap:function(e,t,o){var a=this;a.map=new AMap.Map(e,{resizeEnable:!0,zoom:14,center:t}),a.marker=new AMap.Marker({position:t,map:a.map,icon:o}),a.marker.setMap(a.map),AMap.plugin(["AMap.Geocoder","AMap.ToolBar","AMap.Scale"],function(){a.map.addControl(new AMap.ToolBar),a.map.addControl(new AMap.Scale)}),a.geocoder=new AMap.Geocoder({radius:1e3,extensions:"all"}),AMap.MouseTool&&(a.mouseTool=new AMap.MouseTool(a.map))},initAutocomplate:function(e,t,o){var a=this;AMap.plugin(["AMap.Geocoder","AMap.Autocomplete","AMap.PlaceSearch"],function(){var i={city:o&&"",input:e};a.autocomplete=new AMap.Autocomplete(i),a.placeSearch=new AMap.PlaceSearch({city:o,map:"",pageSize:t}),AMap.event.addListener(a.autocomplete,"select",function(e){console.log("autocomplate select event"),a.autocomplateInput=e.poi.name,a.placeSearch.search(e.poi.name,function(e,t){"complete"===e&&"OK"===t.info?(a.map.clearMap(),a.renderSearchMarker(t.poiList.pois),a.map.setFitView(),a.map.setZoom(14),a.placeSearch.clear()):console.log("没有匹配结果<br>或者结果太多")})})})},initMouseTools:function(){var e=this;e.mouseTool.marker(),e.mouseTool.on("draw",function(t){e.map.clearMap();var o=t.obj.getPosition();e.geocoder.getAddress(o,function(t,a){if("complete"===t&&"OK"===a.info){console.log(a);var i=a.regeocode.addressComponent,n={location:o,address:i.district+i.street+i.streetNumber,name:a.regeocode.formattedAddress};e.renderSearchMarker([n],!0)}})})},searchDefaultSuggestion:function(e){var t=this;t.placeSearch.search(this.autocomplateInput,function(e,o){"complete"===e&&"OK"===o.info?(t.map.clearMap(),t.renderSearchMarker(o.poiList.pois),t.map.setFitView(),t.map.setZoom(14),t.placeSearch.clear()):console.log("没有匹配结果<br>或者结果太多")})},renderSearchMarker:function(e){for(var t,o=this,a=new AMap.InfoWindow({offset:new AMap.Pixel(0,-30)}),i=0,n=function(e){i++,t=new AMap.Marker({position:e.location,map:o.map,icon:"http://webapi.amap.com/theme/v1.3/markers/n/mark_r"+i+".png",draggable:!0}),t.content=o.$refs["marker-content"],t.setExtData({isMoved:!0,poiIndex:i}),t.on("click",function(t){o.selectedPoi.location=e.location,o.selectedPoi.address=e.address,o.selectedPoi.name=e.name,o.selectedPoi.isMoved=this.getExtData().isMoved,a.setContent(t.target.content),a.open(o.map,t.target.getPosition())}),t.emit("click",{target:t}),t.on("dragstart",function(e){o.map.clearInfoWindow()}),t.on("dragend",function(e){var t=this;console.log(e.lnglat),t.setExtData({isMoved:!0});var i=e.lnglat.lat,n=e.lnglat.lng;t.setPosition(new AMap.LngLat(n,i)),o.geocoder.getAddress(e.lnglat,function(i,n){if("complete"===i&&"OK"===n.info){console.log(n);var s=n.regeocode.addressComponent;o.selectedPoi.location=e.lnglat,o.selectedPoi.address=s.district+s.street+s.streetNumber,o.selectedPoi.name=n.regeocode.formattedAddress,o.selectedPoi.isMoved=t.getExtData().isMoved,console.log(o.selectedPoi.name),a.setContent(e.target.content),a.open(o.map,e.target.getPosition())}})})},s=0,r=e;s<r.length;s++){n(r[s])}},initAMapDistrictSearch:function(e,t){var o=this;AMap.service("AMap.DistrictSearch",function(){var a={subdistrict:1,extensions:"base",showbiz:!1,level:"district"};new AMap.DistrictSearch(a).search(e,function(e,a){var i=a.districtList[0];o.map.setCenter(i.center),o.map.setZoom(12),t(i)})})}}}},function(e,t,o){o(1);var a=o(2)(o(0),o(3),null,null);t.__esModule=!0,t.default=a.exports}])});
//# sourceMappingURL=main.js.map